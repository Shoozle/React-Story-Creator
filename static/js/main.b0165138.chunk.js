(this["webpackJsonpreact-story-creator"]=this["webpackJsonpreact-story-creator"]||[]).push([[0],[,,,,function(e,t,a){e.exports={bookSection:"storybook_bookSection__2F6B_",storyTitle:"storybook_storyTitle__2KVxB",pageArea:"storybook_pageArea__-CvQd",page:"storybook_page__1BQiV",canvas:"storybook_canvas__DLQa6",buttonArea:"storybook_buttonArea__1UoCH"}},function(e,t,a){e.exports={canvas:"canvas_canvas__1NvqR",drawingArea:"canvas_drawingArea__2ePnn",pageNumber:"canvas_pageNumber__2-V9Y",title:"canvas_title__C4dr1",storyArea:"canvas_storyArea__37dT7"}},,,function(e,t,a){e.exports={Toolbox:"toolbox_Toolbox__2YJJF",colorful:"toolbox_colorful__3cxTy",bottom:"toolbox_bottom__3ccIv",side:"toolbox_side__1TK3e"}},,function(e,t,a){e.exports={Flowchartarea:"flowchart_Flowchartarea__Ln6sf",Flowchart:"flowchart_Flowchart__3xsyz",box:"flowchart_box__2tbyc"}},function(e,t,a){e.exports={Modal:"modal_Modal__12FWS",ModalOpen:"modal_ModalOpen__skEoq",ModalClosed:"modal_ModalClosed__2asIj"}},,,function(e,t,a){e.exports={Button:"button_Button__1O76R"}},,function(e,t,a){e.exports={Cursor:"cursor_Cursor__32MIa"}},function(e,t,a){e.exports={backdrop:"backdrop_backdrop__8GLTU"}},function(e,t,a){e.exports={Navbar:"navbar_Navbar__2L923"}},function(e,t,a){e.exports={Title:"title_Title__3JYWz"}},,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a(13),c=a.n(o),s=(a(24),a(2)),r=a(5),i=a.n(r),l=a(8),d=a.n(l),u=(a(25),a(14)),j=a.n(u),b=a(1),x=function(e){return Object(b.jsx)("button",{className:j.a.Button,onClick:e.onClick,children:e.text})},p=a(15),g=function(e){var t,a=e.onUndo,n=e.onRedo,o=e.onFill,c=e.onPrevPage,s=e.onNewPage,r=e.onNextPage,i=e.brushSize,l=e.onBrushSizeChange,u=e.color,j=e.setColor,g=e.onPreview;return l&&(t=Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{htmlFor:"size",children:"Brush Size"}),Object(b.jsx)("input",{type:"range",id:"size",value:i,min:"1",max:"60",onChange:function(e){return l(e)}})]}),Object(b.jsx)(p.a,{className:d.a.colorful,color:u,onChange:j})]})),Object(b.jsxs)("div",{className:"".concat(d.a.Toolbox," ").concat("side"===e.placement?d.a.side:d.a.bottom),children:[a&&Object(b.jsx)(x,{onClick:a,text:"Undo"}),o&&Object(b.jsx)(x,{onClick:o,text:"Fill"}),n&&Object(b.jsx)(x,{onClick:n,text:"Redo"}),t,c&&Object(b.jsx)(x,{onClick:c,text:"Previous Page"}),s&&Object(b.jsx)(x,{onClick:s,text:"Add a Page"}),r&&Object(b.jsx)(x,{onClick:r,text:"Next Page"}),g&&Object(b.jsx)(x,{onClick:g,text:"Preview Story"})]})},O=a(16),h=a.n(O),f=function(e){return Object(b.jsx)("div",{style:e.cursorStyle,className:h.a.Cursor})},_=function(e){var t=Object(n.useRef)(null),a=Object(n.useRef)(null),o=Object(n.useState)(!1),c=Object(s.a)(o,2),r=c[0],l=c[1],d=Object(n.useContext)(z),u=d.storyState.pages,j=e.pageNum,x=Object(n.useState)(20),p=Object(s.a)(x,2),O=p[0],h=p[1],_=Object(n.useState)("#000"),v=Object(s.a)(_,2),m=v[0],y=v[1],N=Object(n.useState)({}),C=Object(s.a)(N,2),P=C[0],w=C[1],S=function(e){w({top:e.pageY-O/2,left:e.pageX-O/2,height:"".concat(O,"px"),width:"".concat(O,"px"),border:"1px solid ".concat(m)})};Object(n.useEffect)((function(){var e=t.current,n=a.current,o=e.getContext("2d");0===u[j].edits.length&&(o.fillStyle="white",o.fillRect(0,0,400,400),d.dispatchStory({type:"ADD_PAINTING",payload:{pageNum:j,edit:e.toDataURL()}}));var c=new Image;c.src=u[j].edits[u[j].editIndex-1],c.onload=function(){return o.drawImage(c,0,0)},void 0===u[j].text&&(n.value=""),n.value=u[j].text}),[u,j,d]);var I=function(){if(r){var e=t.current;e.getContext("2d").beginPath(),d.dispatchStory({type:"ADD_PAINTING",payload:{pageNum:j,edit:e.toDataURL()}})}l(!1),w({display:"none"})},T=Object(b.jsx)(g,{onUndo:function(){u[j].editIndex>1&&d.dispatchStory({type:"UNDO_PAINTING",payload:{pageNum:j}})},onRedo:function(){u[j].editIndex<d.storyState.pages[j].edits.length&&d.dispatchStory({type:"REDO_PAINTING",payload:{pageNum:j}})},onFill:function(){var e=t.current,a=e.getContext("2d");a.fillStyle=m,a.fillRect(0,0,400,400),d.dispatchStory({type:"ADD_PAINTING",payload:{pageNum:j,edit:e.toDataURL()}})},onBrushSizeChange:function(e){h(e.target.value)},brushSize:O,colorPicker:O,placement:"side",color:m,setColor:y}),A=Object(b.jsx)(g,{onPrevPage:function(){j>0&&e.onPageChange((function(e){return e-1}))},onNewPage:function(){u.length<20&&(d.dispatchStory({type:"ADD_PAGE",payload:{pageNum:j}}),e.onPageChange(u.length))},onNextPage:function(){j<u.length-1&&e.onPageChange((function(e){return e+1}))},placement:"bottom"});return Object(b.jsxs)("div",{children:[Object(b.jsx)(f,{cursorStyle:P}),Object(b.jsxs)("div",{className:i.a.drawingArea,children:[Object(b.jsx)("div",{className:i.a.drawingButtons,children:T}),Object(b.jsxs)("div",{className:i.a.storyArea,children:[Object(b.jsx)("canvas",{className:i.a.canvas,width:"400px",height:"400px",ref:t,id:"drawing-canvas",onMouseEnter:function(e){return S(e)},onMouseDown:function(){l(!0)},onMouseMove:function(e){var a=t.current;S(e),function(e,t){var a=e.getContext("2d"),n=t.x,o=t.y;if(r){var c=e.offsetLeft-window.scrollX,s=e.offsetTop-window.scrollY;a.lineWidth=O,a.lineCap="round",a.strokeStyle=m,a.lineTo(n-c,o-s),a.stroke(),a.beginPath(),a.moveTo(n-c,o-s)}}(a,{x:e.clientX,y:e.clientY})},onMouseUp:I,onMouseLeave:I}),Object(b.jsxs)("p",{className:i.a.pageNumber,children:["Page ",j+1," of ",d.storyState.pages.length]}),Object(b.jsx)("div",{className:i.a.pageButtons,children:A}),Object(b.jsx)("textarea",{ref:a,type:"textarea",col:"30",row:"12",maxLength:"200",placeholder:"Page writing",onChange:function(e){var t=e.target.value;d.dispatchStory({type:"UPDATE_TEXT",payload:{pageNum:j,text:t}})}})]})]})]})},v=a(10),m=a.n(v),y=a(17),N=a.n(y),C=function(e){return Object(b.jsx)("div",{className:N.a.backdrop,children:e.children})},P=a(11),w=a.n(P),S=function(e){var t;return t=e.show?w.a.modalOpen:w.a.modalClosed,Object(b.jsx)("div",{className:[w.a.Modal,t].join(" "),children:e.children})},I=a(4),T=a.n(I),A=function(e){var t,a,o=Object(n.useContext)(z).storyState,c=Object(n.useRef)(null),r=Object(n.useRef)(null),i=Object(n.useState)(0),l=Object(s.a)(i,2),d=l[0],u=l[1],j=Object(n.useState)({}),p=Object(s.a)(j,2),g=p[0],O=p[1],h=Object(n.useState)({}),f=Object(s.a)(h,2),_=f[0],v=f[1],m=Object(n.useState)(!1),y=Object(s.a)(m,2),N=y[0],P=y[1],w=function(){return window.innerWidth>900?2:1};Object(n.useEffect)((function(){var e=c.current.getContext("2d"),t=o.pages[d].edits[o.pages[d].edits.length-1];O({imageSrc:t,text:o.pages[d].text});var a=new Image;if(a.src=t,a.onload=function(){return e.drawImage(a,0,0)},2===w())try{var n=r.current.getContext("2d"),s=o.pages[d+1].edits[o.pages[d+1].edits.length-1];v({imageSrc:s,text:o.pages[d+1].text});var i=new Image;i.src=s,i.onload=function(){return n.drawImage(i,0,0)},P(!1)}catch(l){P(!0)}}),[d,o.pages,N]),t=Object(b.jsxs)("div",{className:T.a.page,children:[Object(b.jsx)("canvas",{width:"400px",height:"400px",ref:c,className:T.a.canvas}),Object(b.jsx)("p",{children:g.text||"Please enter some text for this page"})]}),window.innerWidth>900&&(a=Object(b.jsxs)("div",{className:T.a.page,children:[Object(b.jsx)("canvas",{width:"400px",height:"400px",ref:r,className:T.a.canvas}),Object(b.jsx)("p",{children:_.text||"Please enter some text for this page"})]}));return Object(b.jsx)(C,{children:Object(b.jsx)(S,{show:!0,children:Object(b.jsxs)("div",{className:T.a.bookSection,children:[Object(b.jsx)("h1",{className:T.a.storyTitle,children:o.title||"Please enter a title for your story"}),Object(b.jsxs)("div",{className:T.a.pageArea,children:[t,!N&&a]}),Object(b.jsxs)("div",{className:T.a.buttonArea,children:[Object(b.jsx)(x,{text:"Previous Page",onClick:function(){(d>=2||d>=1&&1===w())&&(u(d-w()),P(!1))}}),Object(b.jsx)(x,{text:"Close",onClick:e.onClose}),Object(b.jsx)(x,{text:"Next Page",onClick:function(){d<o.pages.length-w()&&u(d+w())}})]})]})})})},k=function(e){var t=Object(n.useContext)(z).storyState.pages,a=Object(n.useState)(null),o=Object(s.a)(a,2),c=o[0],r=o[1],i=t.map((function(t,a){var n="Page ".concat(a+1);return Object(b.jsx)("div",{className:m.a.box,onClick:function(){return e.onPageChange(a)},children:Object(b.jsx)("span",{children:n})},a)})),l=function(){r(null)};return Object(b.jsxs)("div",{className:m.a.Flowchartarea,children:[Object(b.jsx)("div",{className:m.a.Flowchart,children:i}),c,Object(b.jsx)(g,{onPreview:function(){r(Object(b.jsx)(A,{onClose:l}))}})]})},D=a(18),E=a.n(D),R=function(){return Object(b.jsx)("nav",{className:E.a.Navbar,children:Object(b.jsxs)("ul",{children:[Object(b.jsx)("li",{children:"Home"}),Object(b.jsx)("li",{children:"Browse"}),Object(b.jsx)("li",{children:"Sign in"})]})})},F=a(3),U=a(6),M=function(e,t){var a=e.pages,n=t.payload,o=n.edit,c=n.pageNum;switch(t.type){case"UNDO_PAINTING":var s=Object(U.a)(e.pages);return s[c].editIndex--,Object(F.a)(Object(F.a)({},e),{},{pages:s});case"REDO_PAINTING":var r=Object(U.a)(e.pages);return r[c].editIndex++,Object(F.a)(Object(F.a)({},e),{},{pages:r});case"ADD_PAINTING":var i=Object(U.a)(e.pages);return i[c].edits.splice(i[c].editIndex),a[c].edits.push(o),a[c].editIndex++,Object(F.a)(Object(F.a)({},e),{},{pages:i});case"ADD_PAGE":var l=Object(U.a)(e.pages);return l.push({text:"",editIndex:0,edits:[]}),Object(F.a)(Object(F.a)({},e),{},{pages:l});case"UPDATE_TEXT":var d=Object(U.a)(e.pages);return d[c].text=t.payload.text,Object(F.a)(Object(F.a)({},e),{},{pages:d});case"UPDATE_TITLE":var u=t.payload.title;return Object(F.a)(Object(F.a)({},e),{},{title:u});default:alert("No action for this type")}},B=(a(27),a(19)),L=a.n(B),G=function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],o=t[1],c=Object(n.useContext)(z);return Object(b.jsx)("input",{placeholder:"Story title",value:a,onChange:function(e){o(e.target.value),c.dispatchStory({type:"UPDATE_TITLE",payload:{title:a}})},maxLength:80,className:L.a.Title})},z=Object(n.createContext)();var Y=function(){var e=Object(n.useState)(0),t=Object(s.a)(e,2),a=t[0],o=t[1],c=function(e){o(e)},r=Object(n.useReducer)(M,{title:"",pages:[{text:"",editIndex:0,edits:[]}]}),i=Object(s.a)(r,2),l=i[0],d=i[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(R,{}),Object(b.jsxs)(z.Provider,{value:{storyState:l,dispatchStory:d},children:[Object(b.jsx)(G,{}),Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)(_,{pageNum:a,onPageChange:c}),Object(b.jsx)(k,{pageNum:a,onPageChange:c})]})]})]})};c.a.render(Object(b.jsx)(Y,{}),document.getElementById("root"))}],[[28,1,2]]]);
//# sourceMappingURL=main.b0165138.chunk.js.map