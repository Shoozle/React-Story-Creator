(this["webpackJsonpreact-story-creator"]=this["webpackJsonpreact-story-creator"]||[]).push([[0],[,,,,function(e,t,a){e.exports={bookSection:"storybook_bookSection__2F6B_",storyTitle:"storybook_storyTitle__2KVxB",pageArea:"storybook_pageArea__-CvQd",page:"storybook_page__1BQiV",canvas:"storybook_canvas__DLQa6",buttonArea:"storybook_buttonArea__1UoCH"}},function(e,t,a){e.exports={canvas:"canvas_canvas__1NvqR",drawingArea:"canvas_drawingArea__2ePnn",pageNumber:"canvas_pageNumber__2-V9Y",title:"canvas_title__C4dr1",storyArea:"canvas_storyArea__37dT7"}},,,function(e,t,a){e.exports={Toolbox:"toolbox_Toolbox__2YJJF",colorful:"toolbox_colorful__3cxTy",bottom:"toolbox_bottom__3ccIv",side:"toolbox_side__1TK3e"}},,function(e,t,a){e.exports={Modal:"modal_Modal__12FWS",ModalOpen:"modal_ModalOpen__skEoq",ModalClosed:"modal_ModalClosed__2asIj"}},,function(e,t,a){e.exports={Button:"button_Button__1O76R",FlowchartButton:"button_FlowchartButton__8M2zR"}},function(e,t,a){e.exports={Flowchartarea:"flowchart_Flowchartarea__Ln6sf",Flowchart:"flowchart_Flowchart__3xsyz",box:"flowchart_box__2tbyc"}},,,function(e,t,a){e.exports={Cursor:"cursor_Cursor__32MIa"}},function(e,t,a){e.exports={backdrop:"backdrop_backdrop__8GLTU"}},function(e,t,a){e.exports={Navbar:"navbar_Navbar__2L923"}},function(e,t,a){e.exports={Title:"title_Title__3JYWz"}},,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a(14),c=a.n(o),s=(a(24),a(2)),r=a(5),i=a.n(r),l=a(8),u=a.n(l),d=(a(25),a(12)),j=a.n(d),b=a(1),x=function(e){return Object(b.jsx)("button",{className:j.a.FlowchartButton,onClick:e.onClick,children:e.children})},p=function(e){return Object(b.jsx)("button",{className:j.a.Button,onClick:e.onClick,children:e.text})},g=a(15),h=function(e){var t,a=e.onUndo,o=e.onRedo,c=e.onFill,s=e.onPrevPage,r=e.onNewPage,i=e.onNextPage,l=e.brushSize,d=e.onBrushSizeChange,j=e.color,x=e.setColor,h=e.onPreview,O=e.pageNum,f=Object(n.useContext)(Y).storyState.pages;return d&&(t=Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{htmlFor:"size",children:"Brush Size"}),Object(b.jsx)("input",{type:"range",id:"size",value:l,min:"1",max:"60",onChange:function(e){return d(e)}})]}),Object(b.jsx)(g.a,{className:u.a.colorful,color:j,onChange:x})]})),Object(b.jsxs)("div",{className:"".concat(u.a.Toolbox," ").concat("side"===e.placement?u.a.side:u.a.bottom),children:[a&&Object(b.jsx)(p,{onClick:a,text:"Undo"}),c&&Object(b.jsx)(p,{onClick:c,text:"Fill"}),o&&Object(b.jsx)(p,{onClick:o,text:"Redo"}),t,O>0&&Object(b.jsx)(p,{onClick:s,text:"Previous Page"}),f.length<20&&r&&Object(b.jsx)(p,{onClick:r,text:"Add a Page"}),f.length>1&&O<f.length-1&&Object(b.jsx)(p,{onClick:i,text:"Next Page"}),h&&Object(b.jsx)(p,{onClick:h,text:"Preview Story"})]})},O=a(16),f=a.n(O),_=function(e){return Object(b.jsx)("div",{style:e.cursorStyle,className:f.a.Cursor})},v=function(e){var t=Object(n.useRef)(null),a=Object(n.useRef)(null),o=Object(n.useState)(!1),c=Object(s.a)(o,2),r=c[0],l=c[1],u=Object(n.useContext)(Y),d=u.storyState.pages,j=e.pageNum,x=Object(n.useState)(20),p=Object(s.a)(x,2),g=p[0],O=p[1],f=Object(n.useState)("#000"),v=Object(s.a)(f,2),m=v[0],y=v[1],N=Object(n.useState)({}),C=Object(s.a)(N,2),w=C[0],P=C[1],S=function(e){P({top:e.pageY-g/2,left:e.pageX-g/2,height:"".concat(g,"px"),width:"".concat(g,"px"),border:"1px solid ".concat(m)})};Object(n.useEffect)((function(){var e=t.current,n=a.current,o=e.getContext("2d");0===d[j].edits.length&&(o.fillStyle="white",o.fillRect(0,0,400,400),u.dispatchStory({type:"ADD_PAINTING",payload:{pageNum:j,edit:e.toDataURL()}}));var c=new Image;c.src=d[j].edits[d[j].editIndex-1],c.onload=function(){return o.drawImage(c,0,0)},void 0===d[j].text&&(n.value=""),n.value=d[j].text}),[d,j,u]);var I=function(){if(r){var e=t.current;e.getContext("2d").beginPath(),u.dispatchStory({type:"ADD_PAINTING",payload:{pageNum:j,edit:e.toDataURL()}})}l(!1),P({display:"none"})},T=Object(b.jsx)(h,{onUndo:function(){d[j].editIndex>1&&u.dispatchStory({type:"UNDO_PAINTING",payload:{pageNum:j}})},onRedo:function(){d[j].editIndex<u.storyState.pages[j].edits.length&&u.dispatchStory({type:"REDO_PAINTING",payload:{pageNum:j}})},onFill:function(){var e=t.current,a=e.getContext("2d");a.fillStyle=m,a.fillRect(0,0,400,400),u.dispatchStory({type:"ADD_PAINTING",payload:{pageNum:j,edit:e.toDataURL()}})},onBrushSizeChange:function(e){O(e.target.value)},brushSize:g,colorPicker:g,placement:"side",color:m,setColor:y}),k=Object(b.jsx)(h,{onPrevPage:function(){j>0&&e.onPageChange((function(e){return e-1}))},onNewPage:function(){d.length<20&&(u.dispatchStory({type:"ADD_PAGE",payload:{pageNum:j}}),e.onPageChange(d.length))},onNextPage:function(){j<d.length-1&&e.onPageChange((function(e){return e+1}))},placement:"bottom",pageNum:j});return Object(b.jsxs)("div",{children:[Object(b.jsx)(_,{cursorStyle:w}),Object(b.jsxs)("div",{className:i.a.drawingArea,children:[Object(b.jsx)("div",{className:i.a.drawingButtons,children:T}),Object(b.jsxs)("div",{className:i.a.storyArea,children:[Object(b.jsx)("canvas",{className:i.a.canvas,width:"400px",height:"400px",ref:t,id:"drawing-canvas",onMouseEnter:function(e){return S(e)},onMouseDown:function(){l(!0)},onMouseMove:function(e){var a=t.current;S(e),function(e,t){var a=e.getContext("2d"),n=t.x,o=t.y;if(r){var c=e.offsetLeft-window.scrollX,s=e.offsetTop-window.scrollY;a.lineWidth=g,a.lineCap="round",a.strokeStyle=m,a.lineTo(n-c,o-s),a.stroke(),a.beginPath(),a.moveTo(n-c,o-s)}}(a,{x:e.clientX,y:e.clientY})},onMouseUp:I,onMouseLeave:I}),Object(b.jsxs)("p",{className:i.a.pageNumber,children:["Page ",j+1," of ",u.storyState.pages.length]}),Object(b.jsx)("div",{className:i.a.pageButtons,children:k}),Object(b.jsx)("textarea",{ref:a,type:"textarea",col:"30",row:"12",maxLength:"200",placeholder:"Page writing",onChange:function(e){var t=e.target.value;u.dispatchStory({type:"UPDATE_TEXT",payload:{pageNum:j,text:t}})}})]})]})]})},m=a(13),y=a.n(m),N=a(17),C=a.n(N),w=function(e){return Object(b.jsx)("div",{className:C.a.backdrop,children:e.children})},P=a(10),S=a.n(P),I=function(e){var t;return t=e.show?S.a.modalOpen:S.a.modalClosed,Object(b.jsx)("div",{className:[S.a.Modal,t].join(" "),children:e.children})},T=a(4),k=a.n(T),A=function(e){var t,a,o=Object(n.useContext)(Y).storyState,c=Object(n.useRef)(null),r=Object(n.useRef)(null),i=Object(n.useState)(0),l=Object(s.a)(i,2),u=l[0],d=l[1],j=Object(n.useState)({}),x=Object(s.a)(j,2),g=x[0],h=x[1],O=Object(n.useState)({}),f=Object(s.a)(O,2),_=f[0],v=f[1],m=Object(n.useState)(!1),y=Object(s.a)(m,2),N=y[0],C=y[1],P=function(){return window.innerWidth>900?2:1};Object(n.useEffect)((function(){var e=c.current.getContext("2d"),t=o.pages[u].edits[o.pages[u].edits.length-1];h({imageSrc:t,text:o.pages[u].text});var a=new Image;if(a.src=t,a.onload=function(){return e.drawImage(a,0,0)},2===P())try{var n=r.current.getContext("2d"),s=o.pages[u+1].edits[o.pages[u+1].edits.length-1];v({imageSrc:s,text:o.pages[u+1].text});var i=new Image;i.src=s,i.onload=function(){return n.drawImage(i,0,0)},C(!1)}catch(l){C(!0)}}),[u,o.pages,N]),t=Object(b.jsxs)("div",{className:k.a.page,children:[Object(b.jsx)("canvas",{width:"400px",height:"400px",ref:c,className:k.a.canvas}),Object(b.jsx)("p",{children:g.text||"Please enter some text for this page"})]}),window.innerWidth>900&&(a=Object(b.jsxs)("div",{className:k.a.page,children:[Object(b.jsx)("canvas",{width:"400px",height:"400px",ref:r,className:k.a.canvas}),Object(b.jsx)("p",{children:_.text||"Please enter some text for this page"})]}));return Object(b.jsx)(w,{children:Object(b.jsx)(I,{show:!0,children:Object(b.jsxs)("div",{className:k.a.bookSection,children:[Object(b.jsx)("h1",{className:k.a.storyTitle,children:o.title||"Please enter a title for your story"}),Object(b.jsxs)("div",{className:k.a.pageArea,children:[t,!N&&a]}),Object(b.jsxs)("div",{className:k.a.buttonArea,children:[Object(b.jsx)(p,{text:"Previous Page",onClick:function(){(u>=2||u>=1&&1===P())&&(d(u-P()),C(!1))}}),Object(b.jsx)(p,{text:"Close",onClick:e.onClose}),Object(b.jsx)(p,{text:"Next Page",onClick:function(){u<o.pages.length-P()&&d(u+P())}})]})]})})})},D=function(e){var t=Object(n.useContext)(Y).storyState.pages,a=Object(n.useState)(null),o=Object(s.a)(a,2),c=o[0],r=o[1],i=t.map((function(t,a){var n="Page ".concat(a+1);return Object(b.jsx)(x,{onClick:function(){return e.onPageChange(a)},children:Object(b.jsx)("span",{children:n})},a)})),l=function(){r(null)};return Object(b.jsxs)("div",{className:y.a.Flowchartarea,children:[Object(b.jsx)("div",{className:y.a.Flowchart,children:i}),c,Object(b.jsx)(h,{onPreview:function(){r(Object(b.jsx)(A,{onClose:l}))}})]})},F=a(18),R=a.n(F),E=function(){return Object(b.jsx)("nav",{className:R.a.Navbar,children:Object(b.jsxs)("ul",{children:[Object(b.jsx)("li",{children:"Home"}),Object(b.jsx)("li",{children:"Browse"}),Object(b.jsx)("li",{children:"Sign in"})]})})},B=a(3),M=a(6),U=function(e,t){var a=e.pages,n=t.payload,o=n.edit,c=n.pageNum;switch(t.type){case"UNDO_PAINTING":var s=Object(M.a)(e.pages);return s[c].editIndex--,Object(B.a)(Object(B.a)({},e),{},{pages:s});case"REDO_PAINTING":var r=Object(M.a)(e.pages);return r[c].editIndex++,Object(B.a)(Object(B.a)({},e),{},{pages:r});case"ADD_PAINTING":var i=Object(M.a)(e.pages);return i[c].edits.splice(i[c].editIndex),a[c].edits.push(o),a[c].editIndex++,Object(B.a)(Object(B.a)({},e),{},{pages:i});case"ADD_PAGE":var l=Object(M.a)(e.pages);return l.push({text:"",editIndex:0,edits:[]}),Object(B.a)(Object(B.a)({},e),{},{pages:l});case"UPDATE_TEXT":var u=Object(M.a)(e.pages);return u[c].text=t.payload.text,Object(B.a)(Object(B.a)({},e),{},{pages:u});case"UPDATE_TITLE":var d=t.payload.title;return Object(B.a)(Object(B.a)({},e),{},{title:d});default:alert("No action for this type")}},L=(a(27),a(19)),G=a.n(L),z=function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],o=t[1],c=Object(n.useContext)(Y);return Object(b.jsx)("input",{placeholder:"Story title",value:a,onChange:function(e){o(e.target.value),c.dispatchStory({type:"UPDATE_TITLE",payload:{title:a}})},maxLength:80,className:G.a.Title})},Y=Object(n.createContext)();var J=function(){var e=Object(n.useState)(0),t=Object(s.a)(e,2),a=t[0],o=t[1],c=function(e){o(e)},r=Object(n.useReducer)(U,{title:"",pages:[{text:"",editIndex:0,edits:[]}]}),i=Object(s.a)(r,2),l=i[0],u=i[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(E,{}),Object(b.jsxs)(Y.Provider,{value:{storyState:l,dispatchStory:u},children:[Object(b.jsx)(z,{}),Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)(v,{pageNum:a,onPageChange:c}),Object(b.jsx)(D,{pageNum:a,onPageChange:c})]})]})]})};c.a.render(Object(b.jsx)(J,{}),document.getElementById("root"))}],[[28,1,2]]]);
//# sourceMappingURL=main.bb5f7d1e.chunk.js.map